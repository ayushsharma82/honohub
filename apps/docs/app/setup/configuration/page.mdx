export const metadata = {
  title: "Configuration",
  description: "In this guide, you'll learn how to configure HonoHub, define collections, and set up hooks for your project."
};

# Configuration

In this guide, you'll learn how to configure HonoHub, define collections, and set up hooks for your project. {{ className: 'lead' }}

## Hub Configuration

The `defineHub` function is used to define the HonoHub configuration. This function takes an object of type `HubConfig`. You can define the db connector, CollectionSidebar, plugins, and more. Here's an example of how to define a hub - 

```ts
const hubConfig = defineHub({
  db,
  collections: [...],
  plugins: [
    {
      name: "hono-logger",
      bootstrap: (props) => new Hono().use("*", logger()).route("/", props.app),
    },
    useGraphQL(),
    useGraphQLPlayground({
      graphQLEndpoint: "http://localhost:3000/graphql",
    }),
  ],
});
```

### API

| Property    | Description                           | Type                                          | Default            |
| ----------- | ------------------------------------- | --------------------------------------------- | ------------------ |
| db          | Database connector                    | Drizzle Connector                                     | -                  |
| collections | Collections to be defined             | `CollectionConfig[]`                         | -                  |
| plugins     | Plugins to be used                    | `GlobalPlugin[]`                             | -                  |
| serverUrl   | Server URL (For Admin Panel)                           | `string`                                      | `/`                  |

## Collection Configuration

Each collection in HonoHub is defined using the `defineCollection` function. This function takes an object of type `CollectionConfig`. You can define collection's schema, access control, admin settings, and more. Here's an example of how to define a collection -

```ts
const collection = defineCollection({
  slug: "todos",
  schema: schema.todos,
  access: () => true,
  admin: {
    label: { singular: "Todo", plural: "Todos" },
    fields: ["message", { name: "status", label: "Status", required: false }],
  },
  pagination: {
    defaultLimit: 10,
  },
});
```

You can use the `access` property to define access control for the collection. The access property can be a function that returns a boolean or a promise that resolves to a boolean.

### API

| Property             | Description                                           | Type                                          | Default            |
| -------------------- | ----------------------------------------------------- | --------------------------------------------- | ------------------ |
| slug                 | The collection slug                                   | `string`                                        | Table's Name          |
| queryKey             | The key to use for querying                           | Table Column                                     | Table's PK |
| schema*               | The schema for the collection                        | Drizzle Table Schema                               | -                  |
| access               | Access control                                        | `(c) => boolean \| Promise<boolean>`                   | -                  |
| defaultSort          | Default sort order                                    | `string`                                      | -                  |
| listSearchableFields | Fields to be searched via full text search | `TableColumns[]`                              | -                  |
| admin                | Collection admin options                              | `CollectionAdminProps`                        | -                  |
| pagination           | Pagination options                                    | `defaultLimit` and `maxLimit` |                    |
| hooks                | Hooks to modify HonoHub functionality                 | `CollectionHooks`                             | -                  |
| plugins              | Collection plugins                                    | `CollectionPlugin[]`                          | -                  |

## Collection Admin Options

The `admin` property takes an object of type `CollectionAdminProps`. You can define the label for the collection, the fields to be displayed in the admin panel, and more. 
These properties are used to build the _Admin Panel_ for the collection. These actions will run on the server. Here's an example of how to define admin settings for a collection -

```ts
const adminOptions: CollectionAdminProps  = {
    label: { singular: "Todo", plural: "Todos" },
    fields: ["message", { name: "status", label: "Status", required: false }],
    actions: [
        {
          name: "sendResetPasswordEmail",
          label: "Send Reset Password Email",
          icon: "AtSymbolIcon",
          action: (options) => {
            // Your action logic here
          },
        },
      ],
  };
```

### API

| Property | Description | Type | Default |
| -------- | ----------- | ---- | ------- |
| label    | Collection label | `CollectionLabel` | - |
| fields   | Fields to be displayed in the admin panel | `AdminField[]` | - |
| actions  | Actions to be displayed in the admin panel | `AdminAction[]` | - |

## Collection Hooks

The `hooks` property takes an object of type `CollectionHooks`. You can define hooks to run before or after creating, updating, or deleting a record. Here's an example of how to define hooks for a collection -

```ts
const collection = defineCollection({
  // ...
  hooks: {
    afterChange: [
      async ({ doc }) => {
        console.log(doc);
        return undefined;
      },
    ],
  },
});
```

### API

| Property       | Description                           |
| -------------- | ------------------------------------- |
| beforeCreate   | Hook to run before creating a record   |
| afterCreate    | Hook to run after creating a record    |
| beforeUpdate   | Hook to run before updating a record   |
| afterUpdate    | Hook to run after updating a record    |
| beforeDelete   | Hook to run before deleting a record   |
| afterDelete    | Hook to run after deleting a record    |